# Техническое задание на разработку расширения для УТ 11.5: Обмен с сайтом. Загрузка заказов.

**Версия ТЗ:** 1.0
**Статус:** В работе

## 1. Общие сведения

| Параметр | Значение / Описание |
|----------|---------------------|
| **Конфигурация** | 1С:Управление торговлей, редакция 11.5 (11.5.Х.ХХХ) |
| **Режим совместимости** | Не ниже "Версия 8.3.27" |
| **Способ доработки** | **Расширение**  |
| **Наименование расширения** | `на усмотрение` |
| **Префикс объектов** | `на усмотрение` |


## 2. Основание для разработки

Автоматизация процесса приема заказов с интернет-сайта компании для исключения ручного ввода данных, минимизации ошибок и ускорения обработки входящих заявок.

## 3. Цель и назначение

*   **Цель:** Автоматизировать создание документов "Сделка" и "Коммерческое предложение" в УТ 11.5 на основе данных, полученных с внешнего сайта.
*   **Назначение:** Функционал предназначен для использования менеджерами отдела продаж, отделом маркетинга.

## 4. Функциональные требования

### 4.1. Хранение и настройка параметров обмена

*   **1.1:** В расширении должен быть создан **справочник или регистр** для хранения параметров по умолчанию. Он уже определен, с  наименованием.
*   **1.2:** Должен содержать как минимум следующие реквизиты (значения заполняются вручную):
    *   `Соглашение По Умолчанию`
    *   `Клиент(Партнер) по умолчанию` 
    *   `Организация по умолчанию`
    *   `Ответственный по умолчанию` 

### 4.2. Создание документов в УТ 11.5

#### Создание Сделки
*   **2.1:** Для каждого заказа из входящих данных необходимо создать документ **"Сделка"**.
*   **3.2:** Реквизиты Сделки заполняются следующим образом:
    *   **Наименование:** `Номер + " " + Имя` (значения из входящих данных).
    *   **Клиент:** Определяется **автоматически** путем поиска в базе по полю `ИНН` из входящих данных.
        *   Если клиент найден - он подставляется.
        *   Если не найден - используется значение `Клиент(Партнер) по умолчанию` из настроек.
    *   **Соглашение:** Значение `Соглашение По Умолчанию` из настроек.
    *   **Ответственный:** Значение `Ответственный по умолчанию` из настроек.
    *   **Комментарий:** `"Загружено с сайта. "` +  все доступные значения сайта.

#### Создание Коммерческого предложения (КП)
*   **4.1:** На основании созданной Сделки должно быть автоматически создано **"Коммерческое предложение"**.
*   **4.2:** Реквизиты КП заполняются следующим образом:
    *   **Соглашение:** Подставляется из Сделки (равно значению из настроек), для расчета скидок (Уже реализовано).
    *   **Вид цены:** Определяется автоматически из поля **"Вид цен"** выбранного Соглашения.
    *   **Менеджер:** Подставляется `Ответственный По Умолчанию` из настроек (совпадает с ответственным по сделке, если имеется).
    *   **Организация:** Значение `Организация По Умолчанию` из настроек.
*   **4.3:** Табличная часть "Товары" в КП должна быть заполнена номенклатурой на основе входящих данных.
    *   **Цена:** Рассчитывается автоматически системой УТ согласно выбранному Виду цен и Соглашению.
*   **4.4:** Комментарий переносим из сделки.

### 4.3. Отправка уведомления
*   **5.1:** Отправить письмо по почте `Ответственный По Умолчанию` на его эмейл, с указанием нового заказа, комментария, списка товаров